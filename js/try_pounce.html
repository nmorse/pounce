
<html>
  <head>
    <script src="dist/parser.js"></script>
    <script src="dist/runtime.js"></script>
    <script src="test/runtime_test.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    
    <style>
      .box {
        border: lightgray solid 1px;
        margin: 1px 1px;
        padding: 0px 4px;
      }
      .col-container {
        display: flex;
        flex-flow: column wrap;
      }
      .row-container {
        display: flex;
        flex-flow: row nowrap;
        overflow-x: scroll;
      }
      .scroll {
         overflow-x: scroll;
      }
    </style>
  </head>
    <body>
      <div class="" id="try_pounce">
        <div class="col-container">
          <div class="row-container">
            <div class="box" style="min-width:100px;">
              Pounce
            </div>
            <div class="col-container">
              <div>
                &nbsp;
              </div>
              <div>
                <input v-model="ps" v-on:keyup="runPounce()" placeholder="Enter Pounce words here" spellcheck="false" style="width:608px; margin:2px;" />
              </div>
            </div>
          </div>
          <div class="row-container">
            <div class="col-container box" style="min-width:100px;">
              <div v-for="ele in vs" class="box">
                {{ ele }} &nbsp;
              </div>
            </div>
              <!--
                <div class="col-container box" style="height:300px; width: 600px;">
                  <div v-for="(value, key) in words" class="box" style="width:100px;">
                    {{ key }}: {{ value.desc }}
                  </div>
                </div>
              -->
            <div class="row-container" style="min-height:300px;">
              <div v-for="h_instance in vs_history" class="col-container box">
                <!--
                -->
                <div v-for="pl_item in h_instance.pl" class="box" style="width:100px; background-color:rgba(200, 20, 20, 0.3);">
                  {{ pl_item }}&nbsp;
                </div>
                <div v-if="h_instance.term" class="box" style="width:100px; background-color:rgba(20, 20, 200, 0.3);">
                  {{ h_instance.term }}
                </div>
                <div v-for="item in h_instance.stack" class="box" style="width:100px;">
                  {{ item }}&nbsp;
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id="testing">
        <button v-on:click="showRuntimeTests = !showRuntimeTests">toggle Runtime test results</button> Out of {{ totalRuntime_tests }} tests, {{ failedRuntime_tests }} tests failed.
        <table id="runtime_testing" v-show="showRuntimeTests">
          <tr v-for="t in runtime_tests">
            <td><a v-on:click="loadExample(t[0])"><code>{{t[0]}}</code></a></td>
            <td><code>{{t[1]}}</code></td>
            <td>{{ (t[2])? 'passed': 'failed' }}</td>
            <td><code>{{t[3]}}</code></td>
          </tr>
        </table>
      </div>
      <script>
        function loadExample(s) {
          try_pounce.ps = s;
          try_pounce.runPounce();
          testing.showRuntimeTests = false;
        }
        var testing = new Vue({
          el: '#testing',
          data: {
            "showRuntimeTests": false
          , "runtime_tests": runtime_tests
          , "totalRuntime_tests": runtime_tests.length
          , "failedRuntime_tests": runtime_tests.reduce(function (acc, o, i) { if (!o[2]) {return acc+1;} return acc; }, 0),
          "loadExample": loadExample
          }
        });
        var try_pounce = new Vue({
          el: '#try_pounce',
          data: {
            "ps": ""
          , "last_ps": ""
          , "pl": []
          , "vs": []
          , "vs_history": []
          , "words": words
          , "runPounce": function () {
              if (this.ps !== this.last_ps) {
                this.last_ps = this.ps;
                this.vs_history = [];
                this.pl = parse(this.ps);
                this.vs = run(this.pl, [], words, this.vs_history).reverse();
              }
            }
          }
        });
      </script>
    </body>
</html>
